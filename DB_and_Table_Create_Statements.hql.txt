create database newsapi_project;

use newsapi_project; 

CREATE TABLE IF NOT EXISTS news_data_table (
    author STRING,
    title STRING,
    description STRING,
    content STRING,
    published_at TIMESTAMP,
    year INT,
    month INT,
    day INT,
    day_of_week STRING,
    source_id STRING,
    source_name STRING,
    keyword STRING
)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES (
    "separatorChar" = ",",  -- Field separator
    "quoteChar"     = "\"", -- Quote character
    "escapeChar"    = "\\", -- Escape character
    "serialization.null.format" = "" 
)
STORED AS TEXTFILE
TBLPROPERTIES ("skip.header.line.count"="1");

LOAD DATA INPATH <CSVPATH> INTO TABLE news_data_table;
